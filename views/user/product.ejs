<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
  <!-- Custom CSS -->
  <link rel="stylesheet" href="/css/style.css" />
  <title>Products</title>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
</head>

<body class="bg-gray-50">
  <%- include("../partials/nav") %>
  <div class="mt-16"></div>

  <!-- Page Content -->
  <div class="bg-gray-50">
    <div class="max-w-7xl mx-auto px-4">
        <nav class="flex text-sm text-gray-500 mb-6" aria-label="Breadcrumb">
            <ol class="inline-flex items-center space-x-1 md:space-x-2">
              <li class="inline-flex items-center">
                <a href="/home" class="inline-flex items-center text-gray-500 hover:text-gray-700">
                  <i class="fa fa-home mr-1"></i>
                  Home
                </a>
              </li>
              <li>
                <div class="flex items-center">
                  <i class="fa fa-angle-right mx-2 text-gray-400"></i>
                  <span class="text-gray-800 font-medium">Shop</span>
                </div>
              </li>
            </ol>
          </nav>
      <div class="grid grid-cols-12 gap-6">
        <!-- Filters -->
        <aside class="col-span-12 md:col-span-3">
          <div class="bg-white rounded-xl shadow-sm border border-gray-100 p-5 sticky top-20">
            <h3 class="text-sm tracking-widest text-gray-400 mb-4">Filters</h3>

            <!-- Sorting -->
            <div class="mb-6">
              <label for="sortFilter" class="block text-xs font-medium text-gray-500 mb-2">Sort By</label>
              <select id="sortFilter" class="w-full rounded-lg border-gray-300 focus:ring-2 focus:ring-gray-900 text-sm">
                <option value="default">Default</option>
                <option value="priceLowToHigh">Price: Low to High</option>
                <option value="priceHighToLow">Price: High to Low</option>
                <option value="newArrivals">New Arrivals</option>
              </select>
            </div>

            <!-- Category -->
            <div class="mb-6">
              <label for="category" class="block text-xs font-medium text-gray-500 mb-2">Category</label>
              <select id="category" class="w-full rounded-lg border-gray-300 focus:ring-2 focus:ring-gray-900 text-sm">
                <option value="">All</option>
                <% if (categories && categories.length > 0) { %>
                  <% categories.forEach(function(category) { %>
                    <option value="<%= category._id %>"><%= category.name %></option>
                  <% }); %>
                <% } else { %>
                  <option value="" disabled>No categories available</option>
                <% } %>
              </select>
            </div>

            <!-- Brand -->
            <div class="mb-6">
              <label for="brand" class="block text-xs font-medium text-gray-500 mb-2">Brand</label>
              <select id="brand" class="w-full rounded-lg border-gray-300 focus:ring-2 focus:ring-gray-900 text-sm">
                <option value="">All</option>
                <% if (brands && brands.length > 0) { %>
                  <% brands.forEach(function(b) { %>
                    <option value="<%= b._id %>" <%= (filters && filters.brand === String(b._id)) ? 'selected' : '' %>><%= b.name %></option>
                  <% }) %>
                <% } %>
              </select>
            </div>

            <!-- Price Range -->
            <div class="mb-6">
              <span class="block text-xs font-medium text-gray-500 mb-2">Price Range</span>
              <div class="flex items-center gap-3">
                <input type="number" id="minPrice" placeholder="Min" value="<%= (filters && filters.minPrice) ? filters.minPrice : '' %>" class="w-1/2 rounded-lg border-gray-300 focus:ring-2 focus:ring-gray-900 text-sm" />
                <span class="text-gray-400">—</span>
                <input type="number" id="maxPrice" placeholder="Max" value="<%= (filters && filters.maxPrice) ? filters.maxPrice : '' %>" class="w-1/2 rounded-lg border-gray-300 focus:ring-2 focus:ring-gray-900 text-sm" />
              </div>
            </div>

            <!-- Stock -->
            <div class="mb-6">
              <label for="stockFilter" class="block text-xs font-medium text-gray-500 mb-2">Stock Status</label>
              <select id="stockFilter" class="w-full rounded-lg border-gray-300 focus:ring-2 focus:ring-gray-900 text-sm">
                <option value="">All Products</option>
                <option value="inStock">In Stock</option>
                <option value="outOfStock">Out of Stock</option>
              </select>
            </div>

            <!-- Actions -->
            <div class="flex items-center gap-3">
              <button type="button" id="filterButton" class="flex-1 bg-gray-900 text-white text-sm px-4 py-2 rounded-lg hover:bg-gray-800">Apply</button>
              <button id="resetButton" class="flex-1 text-sm px-4 py-2 rounded-lg border border-gray-300 hover:bg-gray-100">Reset</button>
            </div>
          </div>
        </aside>

        <!-- Products -->
        <section class="col-span-12 md:col-span-9">
          <!-- Search Bar -->
         <!-- Search Bar -->
<div class="flex items-center gap-3 mb-6">
    <div class="relative flex-1">
      <input 
        type="text" 
        id="searchInput" 
        placeholder="Search products..." 
        autocomplete="off" 
        class="w-full rounded-lg border-gray-300 focus:ring-2 focus:ring-gray-900 text-base px-4 py-3 pr-12"
      />
      <button 
        id="clearSearchButton" 
        type="button" 
        title="Clear search" 
        class="hidden absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 text-lg"
      >
        <i class="fa fa-times"></i>
      </button>
    </div>
    <button 
      id="searchButton" 
      class="bg-gray-900 text-white text-base px-6 py-3 rounded-lg hover:bg-gray-800"
    >
      Search
    </button>
  </div>

          <!-- Grid -->
          <div id="productGrid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-5">
            <% if (products && products.length > 0) { %>
              <% products.forEach(function(product) { %>
                <a href="/product/<%= product._id %>" class="group bg-white rounded-xl border border-gray-100 shadow-sm hover:shadow-md transition overflow-hidden">
                  <div class="aspect-square w-full overflow-hidden bg-gray-100">
                    <img src="<%= product.mainImage %>" alt="<%= product.name %>" class="h-full w-full object-cover group-hover:scale-105 transition-transform duration-300" />
                  </div>
                  <div class="p-4">
                    <h3 class="text-sm font-medium text-gray-800 line-clamp-1"><%= product.name %></h3>
                    <div class="mt-2 flex items-center justify-between">
                      <span class="text-gray-900 font-semibold">₹<%= (product.price != null) ? product.price.toLocaleString() : 'N/A' %></span>
                      <% if (product.stock > 0) { %>
                        <span class="text-xs px-2 py-1 rounded-full bg-green-100 text-green-700">In stock</span>
                      <% } else { %>
                        <span class="text-xs px-2 py-1 rounded-full bg-red-100 text-red-700">Out of stock</span>
                      <% } %>
                    </div>
                  </div>
                </a>
              <% }); %>
            <% } else { %>
              <div class="col-span-full text-center py-16">
                <p class="text-gray-500">No products found</p>
              </div>
            <% } %>
          </div>

          <!-- Pagination Controls -->
          <div id="paginationControls" class="mt-6"></div>
        </section>
      </div>
    </div>
  </div>

  <div class="pt-6"><%- include("../partials/footer") %></div>
</body>
</html>
